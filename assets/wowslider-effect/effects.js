// blast
// options.cols - columns count
// options.rows - rows count
// options.distance = 1 - flight distance
function ws_blast(k,n,x){function u(b,a,c,d){if(k.support.transform&&k.support.transition){if("number"===typeof a.left||"number"===typeof a.top)a.transform="translate3d("+("number"===typeof a.left?a.left:0)+"px,"+("number"===typeof a.top?a.top:0)+"px,0)";delete a.left;delete a.top;a.transition=c?"all "+c+"ms ease-in-out":"";b.css(a);if(d)b.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){d();b.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")})}else delete a.transfrom,
delete a.transition,c?b.animate(a,{queue:!1,duration:k.duration,complete:d?d:0}):b.stop(1).css(a)}function y(f){var a=Math.max((k.width||d.width())/(k.height||d.height())||3,3);l=l||Math.round(1>a?3:3*a);p=p||Math.round(1>a?3/a:3);for(a=0;a<l*p;a++)b([h[a]=document.createElement("div"),e[a]=document.createElement("div")]).css({position:"absolute",overflow:"hidden"}).appendTo(D).append(b("<img>").css({position:"absolute"}));e=b(e);h=b(h);q(e,f);q(h,f,!0);f={position:"absolute",top:0,left:0,width:"100%",
height:"100%",overflow:"hidden"};m.css(f).append(b("<img>").css(f))}function q(e,a,c,h,n,q){var v=d.width(),w=d.height(),m=b(window).scrollLeft(),z=b(window).scrollTop(),x=b(window).width(),y=b(window).height();b(e).each(function(e){var f=e%l,A=Math.floor(e/l);if(c){var r=B*v*(2*Math.random()-1)+v/2,t=B*w*(2*Math.random()-1)+w/2,g=d.offset();g.left+=r;g.top+=t;g.left<m&&(r-=g.left+m);g.top<z&&(t-=g.top+z);var C=m+x-g.left-v/l;0>C&&(r+=C);g=z+y-g.top-w/p;0>g&&(t+=g)}else r=v*f/l,t=w*A/p;b(this).find("img").css({left:-(v*
f/l)+a.marginLeft,top:-(w*A/p)+a.marginTop,width:a.width,height:a.height});f={left:r,top:t,width:v/l,height:w/p};n&&b.extend(f,n);h?u(b(this),f,k.duration,0===e&&q?q:0):u(b(this),f)})}var b=jQuery,E=b(this),F=x.find(".ws_list"),B=k.distance||1,d=b("<div>").addClass("ws_effect ws_blast"),m=b("<div>").addClass("ws_zoom").appendTo(d),D=b("<div>").addClass("ws_parts").appendTo(d);x.css({overflow:"visible"}).append(d);d.css({position:"absolute",left:0,top:0,width:"100%",height:"100%","z-index":8});var l=
k.cols,p=k.rows,e=[],h=[];this.go=function(f,a){var c=b(n[a]),c={width:c.width(),height:c.height(),marginTop:parseFloat(c.css("marginTop")),marginLeft:parseFloat(c.css("marginLeft"))};e.length||y(c);e.find("img").attr("src",n.get(a).src);u(e,{opacity:1,zIndex:3});h.find("img").attr("src",n.get(f).src);u(h,{opacity:0,zIndex:2});m.find("img").attr("src",n.get(a).src);u(m.find("img"),{transform:"scale(1)"});d.show();F.hide();q(h,c,!1,!0,{opacity:1});q(e,c,!0,!0,{opacity:0},function(){E.trigger("effectEnd");
d.hide()});u(m.find("img"),{transform:"scale(2)"},k.duration,0);c=h;h=e;e=c}};
